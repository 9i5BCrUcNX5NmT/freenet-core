<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Test WS</title>
</head>
<body>
<h1>Websocket Test</h1>
<input id="input" type="text"/>
<button id="btn">Send state</button>
<pre id="log"></pre>
<script>
    let log = console.log;

    const wsUri =
        ((window.location.protocol == "https:" && "wss://") || "ws://") +
        window.location.host +
        "/contract/HjpgVdSziPUmxFoBgTdMkQ8xiwhXdv1qn5ouQvSaApzD/state/updates";
    conn = new WebSocket(wsUri);

    log("Connecting...");

    conn.onopen = function () {
        log("Connected");
    };

    conn.onmessage = function (e) {
        log("Received: " + e.data);
        document.getElementById("log").textContent =
            document.getElementById("log").textContent + "\n" + e.data;
    };

    conn.onclose = function () {
        log("Disconnected");
        conn = null;
    };

    function send() {
        let state = document.getElementById("input").value
        conn.send(state);
    }

    document.getElementById("btn").addEventListener("click", send);
</script>
</body>
</html>